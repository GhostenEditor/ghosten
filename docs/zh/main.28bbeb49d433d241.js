var $localize=Object.assign(void 0===$localize?{}:$localize,{locale:"zh"});
"use strict";(function(global){global.ng=global.ng||{};global.ng.common=global.ng.common||{};global.ng.common.locales=global.ng.common.locales||{};const u=undefined;function plural(val){const n=val;return 5}global.ng.common.locales["zh"]=["zh",[["\u4E0A\u5348","\u4E0B\u5348"],u,u],u,[["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"]],u,[["1","2","3","4","5","6","7","8","9","10","11","12"],["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]],u,[["\u516C\u5143\u524D","\u516C\u5143"],u,u],0,[6,0],["y/M/d","y\u5E74M\u6708d\u65E5",u,"y\u5E74M\u6708d\u65E5EEEE"],["HH:mm","HH:mm:ss","z HH:mm:ss","zzzz HH:mm:ss"],["{1} {0}",u,u,u],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"CNY","\xA5","\u4EBA\u6C11\u5E01",{"AUD":["AU$","$"],"BYN":[u,"\u0440."],"CNY":["\xA5"],"ILR":["ILS"],"JPY":["JP\xA5","\xA5"],"KRW":["\uFFE6","\u20A9"],"PHP":[u,"\u20B1"],"RUR":[u,"\u0440."],"TWD":["NT$"],"USD":["US$","$"],"XXX":[]},"ltr",plural,[[["\u5348\u591C","\u65E9\u4E0A","\u4E0A\u5348","\u4E2D\u5348","\u4E0B\u5348","\u665A\u4E0A","\u51CC\u6668"],u,["\u5348\u591C","\u6E05\u6668","\u4E0A\u5348","\u4E2D\u5348","\u4E0B\u5348","\u665A\u4E0A","\u51CC\u6668"]],[["\u5348\u591C","\u65E9\u4E0A","\u4E0A\u5348","\u4E2D\u5348","\u4E0B\u5348","\u665A\u4E0A","\u51CC\u6668"],u,u],["00:00",["05:00","08:00"],["08:00","12:00"],["12:00","13:00"],["13:00","19:00"],["19:00","24:00"],["00:00","05:00"]]]]})(typeof globalThis!=="undefined"&&globalThis||typeof global!=="undefined"&&global||typeof window!=="undefined"&&window);;
"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[179],{3498:(F,j,s)=>{s.d(j,{k:()=>m});var t=s(4650),l=s(7340),I=s(6895);function b(i,O){if(1&i){const a=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){const g=t.CHM(a).$implicit,y=t.oxw(2).$implicit;return t.KtG(y.buttonClick(g))}),t._uU(1),t.qZA()}if(2&i){const a=O.$implicit;t.xp6(1),t.hij(" ",a," ")}}function C(i,O){if(1&i&&(t.TgZ(0,"div",10),t.YNc(1,b,2,1,"button",11),t.qZA()),2&i){const a=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",a.buttons)}}function w(i,O){if(1&i){const a=t.EpF();t.TgZ(0,"div",2),t.NdJ("mouseenter",function(){const g=t.CHM(a).$implicit;return t.KtG(g.paused=!0)})("mouseleave",function(){const g=t.CHM(a).$implicit;return t.KtG(g.paused=!1)}),t.TgZ(1,"div",3)(2,"strong",4),t._uU(3),t.qZA(),t.TgZ(4,"small"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){const g=t.CHM(a).$implicit,y=t.oxw();return t.KtG(y.remove(g))}),t.qZA()(),t.TgZ(8,"div",6)(9,"div"),t._uU(10),t.qZA(),t.TgZ(11,"div"),t._uU(12),t.qZA()(),t.YNc(13,C,2,1,"div",7),t.TgZ(14,"div",8),t._UZ(15,"div",9),t.qZA()()}if(2&i){const a=O.$implicit;t.Q6J("@slide",void 0),t.xp6(3),t.Oqu(a.type),t.xp6(2),t.Oqu(t.xi3(6,8,a.time,"medium")),t.xp6(5),t.Oqu(a.message),t.xp6(2),t.Oqu(a.detail),t.xp6(1),t.Q6J("ngIf",a.buttons),t.xp6(2),t.Udp("transform","scaleX("+a.progress+")")}}let S=(()=>{class i{constructor(a){this.ngZone=a,this.progress=100}ngOnInit(){let a=performance.now();this.ngZone.runOutsideAngular(()=>{const v=h=>{const g=h-a;this.toastList.forEach(y=>{y.hasOwnProperty("remain")&&!y.paused?(y.remain-=g,y.remain=Math.max(0,y.remain),this.ngZone.run(()=>y.progress=+((y.remain-200)/5e3).toFixed(2)),0===y.remain&&setTimeout(()=>this.remove(y))):y.remain=5e3}),a=h,this.timer=requestAnimationFrame(v)};this.timer=requestAnimationFrame(v)})}remove(a){this.toastList.splice(this.toastList.indexOf(a),1)}ngOnDestroy(){cancelAnimationFrame(this.timer)}}return i.\u0275fac=function(a){return new(a||i)(t.Y36(t.R0b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-toast"]],inputs:{toastList:"toastList"},decls:2,vars:1,consts:[[1,"toast-container","position-fixed","bottom-0","end-0","p-3"],["class","toast show mb-2 overflow-hidden","role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave",4,"ngFor","ngForOf"],["role","alert","aria-live","assertive","aria-atomic","true",1,"toast","show","mb-2","overflow-hidden",3,"mouseenter","mouseleave"],[1,"toast-header"],[1,"me-auto"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close",3,"click"],[1,"toast-body"],["class","mt-2 p-2 border-top text-end",4,"ngIf"],[1,"progress",2,"height","2px","--bs-progress-bg","transparent"],["role","progressbar","aria-label","Example 1px high","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","w-100",2,"transform-origin","left","transition","transform 200ms linear"],[1,"mt-2","p-2","border-top","text-end"],["type","button","class","btn btn-light btn-sm",3,"click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-light","btn-sm",3,"click"]],template:function(a,v){1&a&&(t.TgZ(0,"div",0),t.YNc(1,w,16,11,"div",1),t.qZA()),2&a&&(t.xp6(1),t.Q6J("ngForOf",v.toastList))},dependencies:[I.sg,I.O5,I.uU],encapsulation:2,data:{animation:[(0,l.X$)("slide",[(0,l.eR)(":enter",[(0,l.oB)({opacity:0,transform:"translateX(100%)"}),(0,l.jt)("250ms ease-out",(0,l.oB)({opacity:1,transform:"translateX(0)"}))]),(0,l.eR)(":leave",[(0,l.jt)("250ms ease-out",(0,l.oB)({opacity:0,transform:"translateX(50%)"}))])])]}}),i})();var x=s(8184);let m=(()=>{class i{constructor(a,v,h){this.overlay=a,this.applicationRef=v,this.injector=h}show(a){if(a.time=Date.now(),this.componentRef)this.componentRef.instance.toastList.push(a);else{const v=document.createElement("div");document.body.appendChild(v),this.componentRef=(0,t.LMc)(S,{environmentInjector:this.applicationRef.injector,hostElement:v}),this.applicationRef.attachView(this.componentRef.hostView),this.componentRef.instance.toastList=[a]}}}return i.\u0275fac=function(a){return new(a||i)(t.LFG(x.aV),t.LFG(t.z2F),t.LFG(t.zs3))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},9371:(F,j,s)=>{s.d(j,{J:()=>l});var t=s(4650);let l=(()=>{class I{constructor(){this.rawMenus=[]}generateRoutes(C,w){const S=new Map,x=this.rawMenus.map(m=>{const i={id:m.id,path:m.pageUrl,parentId:typeof m.pageParentID>"u"||null===m.pageParentID?null:+m.pageParentID,component:C,data:{id:m.id},children:[],resolve:{data:w}};return S.set(i.id,i),i});return x.forEach(m=>{if(m.parentId){const i=S.get(m.parentId);i&&i.children.push(m)}}),x.forEach(m=>{m.children.length&&(delete m.component,delete m.resolve)}),x.filter(m=>!m.parentId)}}return I.\u0275fac=function(C){return new(C||I)},I.\u0275prov=t.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})()},9190:(F,j,s)=>{var t=s(1481),l=s(4650),I=s(8746),b=s(529),C=s(8795),w=s(2039),S=s(3498);let x=(()=>{class e{constructor(o,r){r.isEnabled&&r.versionUpdates.subscribe(d=>{console.info("versionUpdates",d),"VERSION_READY"===d.type&&o.show({type:"\u63D0\u793A",message:"\u6709\u65B0\u7248\u672C\uFF0C\u662F\u5426\u66F4\u65B0\uFF1F",buttons:["\u662F"],buttonClick:c=>{c==="\u662F"&&location.reload()}})})}}return e.\u0275fac=function(o){return new(o||e)(l.Y36(S.k),l.Y36(w.yO))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(o,r){1&o&&l._UZ(0,"router-outlet")},dependencies:[C.lC],encapsulation:2}),e})();var m=s(6895),i=s(8184),O=s(4080);let a=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({providers:[S.k],imports:[i.U8,m.ez,O.eL]}),e})();function h(e){return new Promise(n=>e.addEventListener("complete",o=>n(o)))}function g(e){return new Promise(n=>e.addEventListener("success",()=>n(e)))}var G=s(4956);class q{constructor(){this.DBName="GHOSTEN",this.dbRequest=indexedDB.open(this.DBName),this.db$=new Promise(n=>{this.dbRequest.addEventListener("success",o=>n(o.target.result))}),this.dbRequest.addEventListener("upgradeneeded",function(){const n=this.result;Array.from(n.objectStoreNames).forEach(p=>n.deleteObjectStore(p));const o=n.createObjectStore("USER_INTERACTION",{keyPath:"category"}),r=n.createObjectStore("CONFIG",{keyPath:"id",autoIncrement:!0}),d=n.createObjectStore("CONFIG_HISTORY",{keyPath:["id","timestamp"]}),c=n.createObjectStore("EDIT_CONFIG",{keyPath:"type"});o.createIndex("category","category",{unique:!0}),o.createIndex("value","value"),r.createIndex("id","id",{unique:!0}),r.createIndex("description","description"),r.createIndex("url","url"),r.createIndex("parentId","parentId"),d.createIndex("id","id"),d.createIndex("timestamp","timestamp"),c.createIndex("type","type"),c.createIndex("value","value")}),this.dbRequest.addEventListener("error",console.error)}message(n,o){return this.db$.then(r=>{switch(n){case"save":return function V(e,n){const o=e.transaction(["CONFIG","CONFIG_HISTORY"],"readwrite"),r=o.objectStore("CONFIG"),d=o.objectStore("CONFIG_HISTORY");let c=n.id;if(null==c){const p=r.add({pageTitle:"untitled",pageDescription:"untitled",pageUrl:"untitled"});g(p).then(()=>c=p.result).then(()=>g(d.add({id:c,config:n.data,timestamp:Date.now()})))}else g(d.add({id:c,config:n.data,timestamp:Date.now()})).then();return h(o).then(()=>({type:"log",subType:"save",message:"\u4fdd\u5b58\u6210\u529f",data:{id:c}}))}(r,o);case"getLatestConfigByID":return function $(e,{id:n}){const o=e.transaction(["CONFIG","CONFIG_HISTORY"],"readonly"),r=o.objectStore("CONFIG"),d=o.objectStore("CONFIG_HISTORY");h(o).then();const c=d.index("id").openCursor(IDBKeyRange.only(+n),"prev");return g(c).then(()=>{const p=c.result,u=r.get(+n);return g(u).then(()=>({cursor:p,_cursor:u.result}))}).then(({cursor:p,_cursor:u})=>({type:"log",subType:"getLatestConfigByID",data:p?{...p.value,...u}:null}),p=>({type:"error",message:p.toString()}))}(r,o);case"addPage":return function Z(e,n){const o=e.transaction(["CONFIG","CONFIG_HISTORY"],"readwrite"),r=o.objectStore("CONFIG"),d=o.objectStore("CONFIG_HISTORY"),c=r.add(n);return c.addEventListener("success",function(p){d.add({id:c.result,timestamp:Date.now(),config:{metadata:{id:null,name:"Untitled",description:null,status:null},global:{},boards:[{id:"main",type:"main",gt:"root",url:"",size:"",description:"",name:"Main",noFooter:!1,events:null,nodeList:[{type:"root",id:"root"}]}],template:[]}})}),h(o).then(()=>({type:"log",subType:"addPage",message:"\u521b\u5efa\u6210\u529f",data:c.result}))}(r,o);case"editPage":return function k(e,n){const o=e.transaction(["CONFIG"],"readwrite");return o.objectStore("CONFIG").put(n),h(o).then(()=>({type:"log",subType:"editPage",message:"\u4fee\u6539\u6210\u529f"}))}(r,o);case"deletePage":return function U(e,{id:n}){const o=e.transaction(["CONFIG","CONFIG_HISTORY"],"readwrite"),r=o.objectStore("CONFIG"),d=o.objectStore("CONFIG_HISTORY");return r.delete(n),d.index("id").openCursor(IDBKeyRange.only(n)).addEventListener("success",function(c){const p=this.result;p&&(p.delete(),p.continue())}),h(o).then(()=>({type:"log",subType:"deletePage",message:"\u5220\u9664\u6210\u529f"}))}(r,o);case"getPageList":return function K(e){const r=e.transaction("CONFIG","readonly").objectStore("CONFIG").getAll();return g(r).then(()=>({type:"log",subType:"getPageList",message:"\u6570\u636e\u67e5\u8be2\u6210\u529f",data:r.result}))}(r);case"activatePage":return function y(e,n){const o=e.transaction(["CONFIG","EDIT_CONFIG"],"readwrite"),r=o.objectStore("CONFIG"),d=o.objectStore("EDIT_CONFIG"),c=r.get(n);return c.addEventListener("success",()=>{if(!c.result)throw new Error("\u66f4\u65b0\u5931\u8d25");d.put({type:"activated ID",value:n})}),h(o).then(()=>({type:"log",subType:"activatePage",message:"\u66f4\u65b0\u6210\u529f"}))}(r,o);case"getActivatedPageID":return function J(e){const r=e.transaction("EDIT_CONFIG","readonly").objectStore("EDIT_CONFIG").get("activated ID");return g(r).then(()=>({type:"log",subType:"getActivatedPageID",message:"\u6570\u636e\u67e5\u8be2\u6210\u529f",data:r.result}))}(r);case"importDB":return function Q(e,n){return n.arrayBuffer().then(o=>{const r=e.transaction(["CONFIG","CONFIG_HISTORY"],"readwrite"),d=r.objectStore("CONFIG"),c=r.objectStore("CONFIG_HISTORY"),{config:p,history:u}=JSON.parse(G.ZP.inflate(o,{to:"string"}));return d.openCursor().addEventListener("success",function(){const f=this.result;f?(f.delete(),f.continue()):p.forEach(T=>d.add(T))}),c.openCursor().addEventListener("success",function(){const f=this.result;f?(f.delete(),f.continue()):u.forEach(T=>c.add(T))}),h(r).then(()=>({type:"log",subType:"importDB",message:"\u5bfc\u5165\u6210\u529f",data:null}))})}(r,o);case"exportDB":return function z(e){const n=e.transaction(["CONFIG","CONFIG_HISTORY"],"readonly"),o=n.objectStore("CONFIG").getAll(),r=n.objectStore("CONFIG_HISTORY").getAll();return h(n).then(()=>({type:"log",subType:"exportDB",message:"\u6570\u636e\u67e5\u8be2\u6210\u529f",data:new File([G.ZP.deflate(JSON.stringify({config:o.result,history:r.result}),{level:9})],"export.gt",{type:"application/txt"})}))}(r);case"deleteDB":return r.close(),function Y(e){return g(indexedDB.deleteDatabase(e)).then(()=>({type:"error",subType:"deleteDB",message:"\u6570\u636e\u5e93\u5220\u9664\u5931\u8d25"}),()=>({type:"error",subType:"deleteDB",message:"\u6570\u636e\u5e93\u5220\u9664\u5931\u8d25"}))}(this.DBName);case"getNavigations":return function W(e){return g(e.transaction("CONFIG","readonly").objectStore("CONFIG").getAll()).then(r=>{const d=r.result,c=new Map,p=d.map(u=>{const f={id:u.id,label:u.pageTitle,path:u.pageUrl,parentId:typeof u.pageParentID>"u"?void 0:+u.pageParentID,children:[]};return c.set(f.id,f),f});return p.forEach(u=>{if(u.parentId){const f=c.get(u.parentId);f&&(f.children.push(u),u.parent=f)}}),p.forEach(u=>{const f=[];let T=u;for(;T;)f.unshift(T.path),T=T.parent;u.url=f.join("/")}),{type:"log",subType:"getNavigations",message:"\u6570\u636e\u67e5\u8be2\u6210\u529f",data:p.filter(u=>!u.parentId)}})}(r);case"getRoutes":return function X(e){const r=e.transaction("CONFIG","readonly").objectStore("CONFIG").getAll();return g(r).then(()=>({type:"log",subType:"getRoutes",message:"\u6570\u636e\u67e5\u8be2\u6210\u529f",data:r.result}))}(r);default:return Promise.resolve({type:"error",message:"\u672a\u77e5\u65b9\u6cd5"})}})}}var R=s(5698),D=s(515),E=s(4004),P=s(4968),_=s(9300);let tt=(()=>{class e{constructor(){if(this.worker=null,this.message=D.E,this.error=D.E,e.workerConnector)return e.workerConnector;if(!(typeof Worker<"u"))throw new Error("Web Worker is not supported by you browser!");this.worker=new Worker(s.tu(new URL(s.p+s.u(697),s.b))),this.message=(0,P.R)(this.worker,"message"),this.error=(0,P.R)(this.worker,"messageerror")}postMessage(o,r){this.worker&&this.worker.postMessage(o,r)}request(o,r){return this.postMessage({type:o,data:r}),this.message.pipe((0,_.h)(({data:d})=>d.subType===o),(0,E.U)(({data:d})=>d.data),(0,R.q)(1))}terminate(){this.worker&&this.worker.terminate(),e.workerConnector=null}}return e.workerConnector=null,e})(),et=(()=>{class e{constructor(o){this.toast=o,this.worker=new tt,this.gtDatabase=new q}intercept(o,r){return this.resolveWorkerRequest(o).pipe((0,E.U)(d=>new b.Zn({body:d})),(0,R.q)(1))}resolveWorkerRequest(o){switch(o.url){case"getLatestConfigByID":case"getPageList":case"getNavigations":case"getRoutes":case"addPage":case"editPage":case"deletePage":case"activatePage":case"save":case"getActivatedPageID":case"deleteDB":case"importDB":case"exportDB":return this.worker.request(o.url,"get"===o.method.toLocaleLowerCase()?Object.fromEntries(new URLSearchParams(o.params.toString())):o.body);default:return D.E}}}return e.\u0275fac=function(o){return new(o||e)(l.LFG(S.k))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac}),e})();var L=s(9371),ot=s(8505);const rt=[{provide:b.TP,useClass:et,multi:!0},L.J,{provide:l.ip1,useFactory:function nt(e,n){return()=>e.get("getRoutes").pipe((0,ot.b)(o=>n.rawMenus=o))},multi:!0,deps:[b.eN,L.J]}];let st=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=l.oAB({type:e,bootstrap:[x]}),e.\u0275inj=l.cJS({providers:rt,imports:[t.b2.withServerTransition({appId:"serverApp"}),I.PW,b.JF,a,C.Bz.forRoot([{path:"",loadChildren:()=>Promise.all([s.e(37),s.e(3)]).then(s.bind(s,6003)).then(n=>n.MainModule)},{path:"edit",loadChildren:()=>Promise.all([s.e(37),s.e(893)]).then(s.bind(s,2893)).then(n=>n.GtModule)},{path:"**",redirectTo:"404",pathMatch:"full"}]),w.Wr.register("ngsw-worker.js",{enabled:true,registrationStrategy:"registerWhenStable:3000"})]}),e})();(0,l.G48)();const N=new(s(3738));N.dom.style.position="fixed",N.dom.style.left="",N.dom.style.top="",N.dom.style.right="env(safe-area-inset-right)",N.dom.style.bottom="env(safe-area-inset-bottom)",document.body.appendChild(N.dom);const A=()=>{N.update(),requestAnimationFrame(A)};requestAnimationFrame(A),function it(){t.q6().bootstrapModule(st).then(e=>{const n=e.injector.get(l.z2F);(0,t.HJ)(n.components[0])}).catch(e=>console.error(e))}();const M=matchMedia("(prefers-color-scheme: dark)"),B=e=>document.documentElement.dataset.bsTheme=e?"dark":"light",H=()=>{document.body.style.height=`${window.innerHeight}px`,document.documentElement.style.fontSize=Math.max(12,window.innerWidth/100)+"px"};B(M.matches),M.addEventListener("change",e=>B(e.matches)),window.addEventListener("resize",H),window.addEventListener("DOMContentLoaded",H)}},F=>{F.O(0,[736],()=>F(F.s=9190)),F.O()}]);